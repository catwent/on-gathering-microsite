<html>
  <head>
    <title>On Gathering Microsite</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css" type="text/css" />
    <script src="https://cdn.jsdelivr.net/gh/alvinashiatey/Sheets@latest/dist/sheets.umd.min.js"></script>
  </head>
  <body>
      <div class="page"></div>
  </body>
  <script>
    const sheetID = "1F1nb0IVZg47Z79TuuugTdYKkwqkj8YZsdux7b0Ue8hY";
    const page = document.querySelector(".page");
    const sheet = new Sheets(sheetID);
    sheet.getMyData().then(function(data) {
      const title = document.createElement("h1");
      title.innerText = data["Header-Title"];
      page.appendChild(title);

      const description = document.createElement("p");
      description.innerText = data["Meta-Description"];
      page.appendChild(description);

      const collapsedRows = sheet.collapseKeys(
        "Ul-Date",
        "UL-Images",
        "UL-Project"
      );

      const ul = document.createElement("ul")
      for (const row of collapsedRows){
        sheet.createElement({
          tag: "div",
          className: "project",
          children: [
            {tag: "div",
          children: [
              {tag: "h2", content: row["UL-Date"]},
              {tag: "p", content: row["UL-Project"]},
              {
                tag: "img",
                attributes: {
                  src: row["UL-Images"],
                }
              },
          ]
          }
          ],
        });
      }
    });
  </script>
</html>
